<!--
GENERATED FILE - DO NOT EDIT
This file was generated by [MarkdownSnippets](https://github.com/SimonCropp/MarkdownSnippets).
Source File: /docs/mdsource/throws.source.md
To change this file edit the source file and then run MarkdownSnippets.
-->

# Verify a method that throws an Exception

Given a method that throws an Exception

<!-- snippet: MethodThatThrows -->
<a id='snippet-MethodThatThrows'></a>
```cs
static void MethodThatThrows() =>
    throw new("The Message");
```
<sup><a href='/src/Verify.Tests/ThrowsTests.cs#L42-L47' title='Snippet source file'>snippet source</a> | <a href='#snippet-MethodThatThrows' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->

That exception behavior can be verified using `Verify.Throws`:

<!-- snippet: TestMethodThatThrows -->
<a id='snippet-TestMethodThatThrows'></a>
```cs
[Fact]
public Task TestMethodThatThrows() =>
    Throws(MethodThatThrows);
```
<sup><a href='/src/Verify.Tests/ThrowsTests.cs#L7-L13' title='Snippet source file'>snippet source</a> | <a href='#snippet-TestMethodThatThrows' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->

Resulting in the following snapshot file:

<!-- snippet: ThrowsTests.TestMethodThatThrows.verified.txt -->
<a id='snippet-ThrowsTests.TestMethodThatThrows.verified.txt'></a>
```txt
{
  Type: Exception,
  Message: The Message,
  StackTrace: at ThrowsTests.MethodThatThrows()
}
```
<sup><a href='/src/Verify.Tests/ThrowsTests.TestMethodThatThrows.verified.txt#L1-L5' title='Snippet source file'>snippet source</a> | <a href='#snippet-ThrowsTests.TestMethodThatThrows.verified.txt' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->


## IgnoreStackTrace

Often the exception stack trace can be noisy and fragile to causing false failed tests. To exclude it use `IgnoreStackTrace`:


### Fluent API

<!-- snippet: TestMethodThatThrowsIgnoreStackTraceFluent -->
<a id='snippet-TestMethodThatThrowsIgnoreStackTraceFluent'></a>
```cs
[Fact]
public Task TestMethodThatThrowsIgnoreStackTraceFluent() =>
    Throws(MethodThatThrows)
        .IgnoreStackTrace();
```
<sup><a href='/src/Verify.Tests/ThrowsTests.cs#L15-L22' title='Snippet source file'>snippet source</a> | <a href='#snippet-TestMethodThatThrowsIgnoreStackTraceFluent' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->


### Settings api

<!-- snippet: TestMethodThatThrowsIgnoreStackTraceSettings -->
<a id='snippet-TestMethodThatThrowsIgnoreStackTraceSettings'></a>
```cs
[Fact]
public Task TestMethodThatThrowsIgnoreStackTraceSettings()
{
    var settings = new VerifySettings();
    settings.IgnoreStackTrace();
    return Throws(MethodThatThrows, settings);
}
```
<sup><a href='/src/Verify.Tests/ThrowsTests.cs#L24-L34' title='Snippet source file'>snippet source</a> | <a href='#snippet-TestMethodThatThrowsIgnoreStackTraceSettings' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->


### Globally

<!-- snippet: IgnoreStackTraceGlobal -->
<a id='snippet-IgnoreStackTraceGlobal'></a>
```cs
VerifierSettings.IgnoreStackTrace();
```
<sup><a href='/src/Verify.Tests/ThrowsTests.cs#L37-L39' title='Snippet source file'>snippet source</a> | <a href='#snippet-IgnoreStackTraceGlobal' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->


### Result

<!-- snippet: ThrowsTests.TestMethodThatThrowsIgnoreStackTraceFluent.verified.txt -->
<a id='snippet-ThrowsTests.TestMethodThatThrowsIgnoreStackTraceFluent.verified.txt'></a>
```txt
{
  Type: Exception,
  Message: The Message
}
```
<sup><a href='/src/Verify.Tests/ThrowsTests.TestMethodThatThrowsIgnoreStackTraceFluent.verified.txt#L1-L4' title='Snippet source file'>snippet source</a> | <a href='#snippet-ThrowsTests.TestMethodThatThrowsIgnoreStackTraceFluent.verified.txt' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->


## Async

There are specific named `Throws*` method for methods that return a `Task` or a `ValueTask`.


### Task

<!-- snippet: MethodThatThrowsTask -->
<a id='snippet-MethodThatThrowsTask'></a>
```cs
static async Task MethodThatThrowsTask()
{
    await Task.Delay(1);
    throw new("The Message");
}
```
<sup><a href='/src/Verify.Tests/ThrowsTests.cs#L59-L67' title='Snippet source file'>snippet source</a> | <a href='#snippet-MethodThatThrowsTask' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->

<!-- snippet: TestMethodThatThrowsTask -->
<a id='snippet-TestMethodThatThrowsTask'></a>
```cs
[Fact]
public Task TestMethodThatThrowsTask() =>
    ThrowsTask(MethodThatThrowsTask);
```
<sup><a href='/src/Verify.Tests/ThrowsTests.cs#L51-L57' title='Snippet source file'>snippet source</a> | <a href='#snippet-TestMethodThatThrowsTask' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->


### ValueTask

<!-- snippet: MethodThatThrowsValueTask -->
<a id='snippet-MethodThatThrowsValueTask'></a>
```cs
static async ValueTask MethodThatThrowsValueTask()
{
    await Task.Delay(1);
    throw new("The Message");
}
```
<sup><a href='/src/Verify.Tests/ThrowsTests.cs#L77-L85' title='Snippet source file'>snippet source</a> | <a href='#snippet-MethodThatThrowsValueTask' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->

<!-- snippet: TestMethodThatThrowsValueTask -->
<a id='snippet-TestMethodThatThrowsValueTask'></a>
```cs
[Fact]
public Task TestMethodThatThrowsValueTask() =>
    ThrowsValueTask(MethodThatThrowsValueTask);
```
<sup><a href='/src/Verify.Tests/ThrowsTests.cs#L69-L75' title='Snippet source file'>snippet source</a> | <a href='#snippet-TestMethodThatThrowsValueTask' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->
